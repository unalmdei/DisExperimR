[
["introduccion-a-los-experimentos-factoriales.html", "Capítulo 6 Introducción a los Experimentos factoriales 6.1 Experimentos factorial p x q 6.2 Actividad", " Capítulo 6 Introducción a los Experimentos factoriales Un experimento factorial es aquel en el que se estudian simultáneamente varios factores, de modo que los tratamientos se forman por todas las posibles combinaciones de los niveles de los factores. Un experimento factorial no constituye un nuevo diseño experimental, sino un diseño para la formación de los tratamientos. Los experimentos factoriales pueden ser conducidos bajo los lineamientos de cualquier diseño experimental tal como el DCA, DBCA o DCL. Permite obtener más información que en un experimento de un solo factor. Todas las unidades intervienen en la estimación de los efectos principales y de interacción, por lo que el número de repeticiones suele ser elevados. Se requiere un mayor número de unidades experimentales que en los experimentos simples. Todos los niveles de un factor se combinan con todos los niveles de los otros factores, sin embargo no siempre todas las combinaciones son de interés para el investigador. El análisis estadístico y la interpretación de los resultados es más complicado que en los experimentos simples con un solo factor. En un experimento factorial un tratamiento corresponde a la combinación de los niveles de dos o más factores. 6.1 Experimentos factorial p x q Un experimento con dos factores con \\(p\\) y \\(q\\) niveles en un diseño Completo al Azar el modelo aditivo lineal es: \\[y_{ijk}=\\mu + \\alpha_i+\\beta_j+\\alpha\\beta_{ij}+\\epsilon_{ijk}\\] Podemos probar las hipótesis de que las medias marginales son todas iguales, o en términos de los efectos \\(\\alpha_i\\) son todas iguales a cero, y \\(\\beta_j\\) son todas iguales a cero. Además de probar la hipótesis de que los efectos de interacción son todos iguales a cero. ¿Cómo hacemos esto, en qué orden y cómo interpretamos estas pruebas? Uno de los propósitos de un diseño factorial es ser eficiente en la estimación y prueba de los factores A y B en un solo experimento. A menudo estamos interesados principalmente en los efectos principales. A veces, también nos interesa saber si los factores interactúan. En cualquier caso, la primera prueba que deberíamos hacer es la prueba de los efectos de interacción. Ejemplo: Se realizó un experimento con un arreglo factorial 2x3 en DBCA en 4 campos de cultivo el efecto en el rendimiento de maíz obtenido con dos tipos de abono (a1 y a2) y tres dosis (b1=20, b2=30 y b3=40 kg/ha). Los datos se encuentran en el archivo: “factorial1.txt” datos&lt;-read.table(&quot;factorial1.txt&quot;,header=T) str(datos) ## &#39;data.frame&#39;: 24 obs. of 4 variables: ## $ y : num 1.9 2.3 2 2.1 1.8 2.1 2.4 2.9 2.7 2.4 ... ## $ B : int 1 1 1 1 2 2 2 2 3 3 ... ## $ A : int 1 1 1 1 1 1 1 1 1 1 ... ## $ Bloque: int 1 2 3 4 1 2 3 4 1 2 ... datos$Bloque&lt;-as.factor(datos$Bloque) datos$A&lt;-as.factor(datos$A) datos$B&lt;-as.factor(datos$B) library(mosaic) favstats(y~A+B , data = datos) ## A.B min Q1 median Q3 max mean sd n missing ## 1 1.1 1.9 1.975 2.05 2.150 2.3 2.075 0.1707825 4 0 ## 2 2.1 1.8 1.950 2.10 2.250 2.4 2.100 0.2581989 4 0 ## 3 1.2 1.8 2.025 2.25 2.525 2.9 2.300 0.4690416 4 0 ## 4 2.2 2.7 2.850 3.05 3.275 3.5 3.075 0.3500000 4 0 ## 5 1.3 2.4 2.625 2.75 2.825 2.9 2.700 0.2160247 4 0 ## 6 2.3 2.9 2.975 3.10 3.250 3.4 3.125 0.2217356 4 0 modelo&lt;-lm(y~Bloque+A+B+A*B,datos) anova(modelo) ## Analysis of Variance Table ## ## Response: y ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## Bloque 3 0.80458 0.26819 5.0418 0.0129833 * ## A 1 1.00042 1.00042 18.8068 0.0005869 *** ## B 2 2.91000 1.45500 27.3525 9.913e-06 *** ## A:B 2 0.56333 0.28167 5.2950 0.0182032 * ## Residuals 15 0.79792 0.05319 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 par(mfcol=c(1,2)) plot(modelo, 1:2) library(phia) modelo.means &lt;- interactionMeans(modelo,factors=c(&quot;A&quot;,&quot;B&quot;)) modelo.means ## A B adjusted mean std. error ## 1 1 1 2.075 0.1153196 ## 2 2 1 2.100 0.1153196 ## 3 1 2 2.300 0.1153196 ## 4 2 2 3.075 0.1153196 ## 5 1 3 2.700 0.1153196 ## 6 2 3 3.125 0.1153196 plot(modelo.means) Es posible observar que al 5% de significancia hay evidencia de interacción entre el tipo de abono y dosis. ¿Cómo analizar esta interacción? Realizando análisis de Efectos Simples: Análisis de efectos simples testInteractions(modelo, fixed=&quot;A&quot;, across=&quot;B&quot;) ## F Test: ## P-value adjustment method: holm ## B1 B2 Df Sum of Sq F Pr(&gt;F) ## 1 -0.625 -0.40 2 0.80167 7.5352 0.005428 ** ## 2 -1.025 -0.05 2 2.67167 25.1123 3.263e-05 *** ## Residuals 15 0.79792 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 testInteractions(modelo, fixed=&quot;B&quot;, across=&quot;A&quot;) ## F Test: ## P-value adjustment method: holm ## Value Df Sum of Sq F Pr(&gt;F) ## 1 -0.025 1 0.00125 0.0235 0.8802105 ## 2 -0.775 1 1.20125 22.5822 0.0007709 *** ## 3 -0.425 1 0.36125 6.7911 0.0397223 * ## Residuals 15 0.79792 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Análisis de residuales obs.table &lt;- xtabs(modelo.means$&quot;adjusted mean&quot; ~ A + B, modelo.means) obs.table&lt;- addmargins(obs.table,FUN=mean,quiet=TRUE) print(obs.table,digits=4) ## B ## A 1 2 3 mean ## 1 2.075 2.300 2.700 2.358 ## 2 2.100 3.075 3.125 2.767 ## mean 2.088 2.688 2.913 2.563 res.table &lt;- obs.table - obs.table[3,4] # restando la media res.table &lt;- sweep(res.table, 1, res.table[,4]) # restando media fila res.table &lt;- sweep(res.table, 2, res.table[3,]) # restando media comlumna print(res.table, digits=4) ## B ## A 1 2 3 mean ## 1 0.191667 -0.183333 -0.008333 0.000000 ## 2 -0.191667 0.183333 0.008333 0.000000 ## mean 0.000000 0.000000 0.000000 0.000000 testInteractions(modelo,residual=c(&quot;A&quot;,&quot;B&quot;)) ## F Test: ## P-value adjustment method: holm ## Value Df Sum of Sq F Pr(&gt;F) ## 1 (resid.) : 1 (resid.) 0.191667 1 0.44083 8.2872 0.06887 . ## 2 (resid.) : 1 (resid.) -0.191667 1 0.44083 8.2872 0.06887 . ## 1 (resid.) : 2 (resid.) -0.183333 1 0.40333 7.5822 0.06887 . ## 2 (resid.) : 2 (resid.) 0.183333 1 0.40333 7.5822 0.06887 . ## 1 (resid.) : 3 (resid.) -0.008333 1 0.00083 0.0157 1.00000 ## 2 (resid.) : 3 (resid.) 0.008333 1 0.00083 0.0157 1.00000 ## Residuals 15 0.79792 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 matplot(t(res.table[-3,-4]), type=&quot;b&quot;, xaxt=&quot;n&quot;, ylab=&quot;residuales interacción&quot;) axis(1, at=1:3, labels=levels(datos$B)) Utilizando los ejercicios del ejemplo, y con un nivel de significancia del 1% hay evidencia de interacción entre el tipo de abono y dosis. ¿Realizaría un análisis de efectos simples o principales? Análisis de efectos principales model2&lt;-lm(y~Bloque+A+B,datos) library(multcomp) citukey &lt;- confint(glht(model2, linfct = mcp(A = &quot;Tukey&quot;))) summary(citukey) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = y ~ Bloque + A + B, data = datos) ## ## Linear Hypotheses: ## Estimate Std. Error t value Pr(&gt;|t|) ## 2 - 1 == 0 0.4083 0.1155 3.535 0.00255 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) citukey &lt;- confint(glht(model2, linfct = mcp(B = &quot;Tukey&quot;))) summary(citukey) ## ## Simultaneous Tests for General Linear Hypotheses ## ## Multiple Comparisons of Means: Tukey Contrasts ## ## ## Fit: lm(formula = y ~ Bloque + A + B, data = datos) ## ## Linear Hypotheses: ## Estimate Std. Error t value Pr(&gt;|t|) ## 2 - 1 == 0 0.6000 0.1415 4.241 0.00147 ** ## 3 - 1 == 0 0.8250 0.1415 5.831 &lt; 0.001 *** ## 3 - 2 == 0 0.2250 0.1415 1.590 0.27666 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## (Adjusted p values reported -- single-step method) 6.2 Actividad La industria experiemntal examinó el número de roturas de hilo dependiendo de dos tipos de lana y tres niveles de tensión usando una máquina de tejer. (Tukey 1977). Los datos se encuentran en la librería faraway con el nombre de warpbreaks library(faraway) str(warpbreaks) ## &#39;data.frame&#39;: 54 obs. of 3 variables: ## $ breaks : num 26 30 54 25 70 52 51 26 67 18 ... ## $ wool : Factor w/ 2 levels &quot;A&quot;,&quot;B&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ tension: Factor w/ 3 levels &quot;L&quot;,&quot;M&quot;,&quot;H&quot;: 1 1 1 1 1 1 1 1 1 2 ... "]
]
